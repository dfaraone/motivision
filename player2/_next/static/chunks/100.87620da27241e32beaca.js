"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[100],{5731:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ae}});var r=n(2809),o=n(7294),i=n(1120),a=n(3758),l=n(868),u=n(1845),c=n(5104),s=n(327),d=n(1984),f=n(2040),m=(n(6e3),n(2595)),g=n(8319),v=n(4013),p=n(1979),w=n(7569),h=n(6569),Z=n(266),x=n(809),y=n.n(x),j=n(5533),b=n(6686),I=function(e){var t=e.map,r=e.provider;return(0,o.useEffect)((function(){if(null===t||null===r)return function(){};var e=null;return"MAPBOX"===r.type?(0,Z.Z)(y().mark((function o(){var i,a,l;return y().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Promise.all([n.e(98),n.e(150)]).then(n.bind(n,1150));case 2:a=o.sent,l=a.default,e=new l({styleUrl:r.url,accessToken:null!==(i=r.key)&&void 0!==i?i:""}),t.addLayer(e);case 6:case"end":return o.stop()}}),o)})))():(e=new b.Z({zIndex:1,source:new j.Z({url:r.url,attributions:r.attributions,maxZoom:r.maxZoom})}),t.addLayer(e)),function(){e&&t.removeLayer(e)}}),[t,r]),null},O=n(6537),P=n(9472),S=n(1771),k=n(692),z=n(8463),A=n(3763),E=n(3342),T=n(6034),C=n(5803),M=n(5189);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=new P.Z({code:"EPSG:3857"}),V=new O.Z({dataProjection:new P.Z({code:"TILE_PIXELS",units:"tile-pixels",extent:[0,0,4096,4096]})}),F=new z.ZP({stroke:new A.Z({color:"#2196f3",width:3})}),B=function(e){if(!e)return F;try{var t=N({},e);return t.stroke&&(t.stroke=new A.Z(t.stroke)),new z.ZP(t)}catch(n){return console.warn(n),F}},G=new z.ZP({image:new E.Z({fill:new T.Z({color:"#2196f3"}),radius:5,stroke:new A.Z({color:"#ffffff",width:2})})}),W=function(e){if(!e)return G;try{var t=N({},e);return t.stroke&&(t.stroke=new A.Z(t.stroke)),t.fill&&(t.fill=new T.Z(t.fill)),new z.ZP({image:new E.Z(t)})}catch(n){return console.warn(n),G}},_=function(e){var t=e.config,n=e.map,r=e.setSelected,i=e.timeline;return(0,o.useEffect)((function(){var e,o;if(null===t||null===n)return function(){};var a=function(){var e=(0,Z.Z)(y().mark((function e(t,n){var r,a,l,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n);case 2:if(200===(r=e.sent).status){e.next=6;break}return t.setFeatures([]),e.abrupt("return");case 6:return e.next=8,r.json();case 8:a=e.sent,l=V.readFeatures(a,{extent:o.getTileGrid().getTileCoordExtent(t.tileCoord),featureProjection:R}),u=l.filter((function(e){return!i||e.get("timeline")===i})),t.setFeatures(u);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();o=new S.Z({url:"".concat(t.streetview.dataUrl,"/{z}/{x}/{y}.geojson"),tileLoadFunction:a,maxZoom:15});var l=new k.Z({zIndex:100,source:o,opacity:null!==(e=t.map.dataLayer.opacity)&&void 0!==e?e:1,style:function(e,t){var n,r=e.getStyleFunction();if(r)return r.call(e,t);var o=null===(n=e.getGeometry())||void 0===n?void 0:n.getType(),i=e.getProperties().style;return o===M.Z.LINE_STRING||o===M.Z.MULTI_LINE_STRING?B(i):W(i)}});n.addLayer(l);var u=new C.Z({layers:[l],style:function(e,t){var n,r=null===(n=e.getGeometry())||void 0===n?void 0:n.getType(),o=e.getProperties().style;return r===M.Z.LINE_STRING||r===M.Z.MULTI_LINE_STRING?B(o):W(o)}});return u.on("select",(function(e){var t=e.selected;if(t.length&&t[0].getGeometry().getType()===M.Z.POINT){var n=t[0].getProperties(),o={id:n.id,heading:n.heading,height:n.height,date:n.date,lon:n.lon,lat:n.lat,timeline:n.timeline,tileFormat:n.tileFormat,label:n.label};r(o)}})),n.addInteraction(u),function(){n.removeInteraction(u),n.removeLayer(l)}}),[t,n,i]),null},U=n(5057),q=n(9368),X=n(8969),K=n(3095),Q=n(9239),Y=n(8760),H="undefined"!==typeof navigator&&(navigator.userAgent.indexOf("MSIE ")>-1||navigator.userAgent.indexOf("Trident/")>-1),D="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.285 511.285" height="30" width="30"><path fill="#ff9800" d="M425.712,465.099l-160-458.667c-3.008-8.576-17.152-8.576-20.139,0l-160,458.667c-0.405,1.131-0.597,2.304-0.597,3.52c0,41.472,153.195,42.667,170.667,42.667s170.667-1.195,170.667-42.667C426.309,467.424,426.117,466.229,425.712,465.099z" /></svg>'),J=function(e){var t=e.map,n=e.selected,r=(e.setSelected,e.hlookat),i=(e.fov,(0,o.useRef)()),a=(0,o.useRef)(new z.ZP({image:new Q.Z({anchor:[.5,0],src:H?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAB4klEQVRIia3VwUpVURSH8d8+V26mWWGkpkFQTSKahjQpGkURFZFmNAlxEEGDnqBniNRoEjTsQaIHqKYOolQiE5KbSrobaCB293Gfc12zc9ba/4/1wdmHmhVnzcRXpuueD7Wgb3Rbs4BCy2B45nfVjKIO2LqbOII+PW7UiagHjiZ2PE0k50qqsur4wmFNCzi4/WrVASfCI8tVcqpv3HR3BxS6rbpdNaaO6v/Vhuq6K6mOswYEX9G1q7WhYSRMWczNqrZxMN4GCg1/3KsSVVV1mdJKurNVx5dO6TJXciZqOBOmzOXk5W/c5UEJFIJN47lxVVTnqMzWnaU6Tjun4XNWYnQhPPZxr7G8jQsPs+a2Zu/njeVNjWWDo4kY9za5JzjOGBWdzQZz2msXOwbXuQ53/b0SsWXnnysM+iIYrohe0O9kGLORGijfeNjVGlAYsuRK2UA5OENZSZWeTaqO7zQtmUd/TfCydUPhqbV2zfTGP13vAApHNV1LNdPgzjT/q2RGW9XxrV4ti+jtENyyYTA8sbK70X7jljv7AIUehVvtGinV+6F5qxIXUAp8ed/AiawUeBLz+wCdF022a5R9xw0/jCpcsuk8RhQGRMdxCH3bo7+wIvguWhR9U/hk03vHfEhdm38BJVdkVc3BhCcAAAAASUVORK5CYII=":D,rotateWithView:!0})})),l=(0,o.useRef)(new z.ZP({image:new E.Z({fill:new T.Z({color:"#ff9800"}),radius:6,stroke:new A.Z({color:"#fff",width:3})})}));return(0,o.useEffect)((function(){if(null===t)return function(){};var e=new U.Z;i.current=new q.Z({zIndex:1e3,source:e});var n=new X.Z({geometry:new K.Z([0,0])});n.setStyle(a.current),n.setId("radar"),e.addFeature(n);var r=new X.Z({geometry:new K.Z([0,0])});return r.setStyle(l.current),r.setId("point"),e.addFeature(r),t.addLayer(i.current),function(){i.current&&t.removeLayer(i.current)}}),[t]),(0,o.useEffect)((function(){if(i.current){var e=i.current.getSource();if(null===n)return a.current.getImage().setOpacity(0),l.current.getImage().setOpacity(0),void e.changed();var t=new K.Z((0,d.mi)([n.lon,n.lat]));e.getFeatureById("radar").setGeometry(t),a.current.getImage().setOpacity(1),e.getFeatureById("point").setGeometry(t),l.current.getImage().setOpacity(1),e.changed()}}),[t,n]),(0,o.useEffect)((function(){if(null!==t&&null!==n&&i.current){var e=i.current.getSource(),o=(e.getFeatureById("radar"),(0,Y.LW)(r+n.heading+180));a.current.getImage().setRotation(o*(Math.PI/180)),e.changed()}}),[t,n,r]),null},$=function(e){var t=e.map,n=e.searchPlace,r=(0,o.useRef)(),i=(0,o.useRef)(new z.ZP({image:new E.Z({fill:new T.Z({color:"#f44336"}),radius:6,stroke:new A.Z({color:"#fff",width:3})})}));return(0,o.useEffect)((function(){if(null===t)return function(){};var e=new U.Z;r.current=new q.Z({zIndex:1e3,source:e});var n=new X.Z({geometry:new K.Z([0,0])});return n.setId("point"),n.setStyle(i.current),e.addFeature(n),t.addLayer(r.current),function(){r.current&&t.removeLayer(r.current)}}),[t]),(0,o.useEffect)((function(){if(r.current){var e=r.current.getSource();if(null===n)return i.current.getImage().setOpacity(0),void e.changed();var t=new K.Z((0,d.mi)([n.lon,n.lat]));e.getFeatureById("point").setGeometry(t),i.current.getImage().setOpacity(1),e.changed()}}),[t,n]),null},ee=function(e){var t=e.map,n=e.asset,r=(0,o.useRef)(),i=(0,o.useRef)(new z.ZP({image:new E.Z({fill:new T.Z({color:"#f44336"}),radius:6,stroke:new A.Z({color:"#fff",width:3})})}));return(0,o.useEffect)((function(){if(null===t)return function(){};var e=new U.Z;r.current=new q.Z({zIndex:1e3,source:e});var n=new X.Z({geometry:new K.Z([0,0])});return n.setId("point"),n.setStyle(i.current),e.addFeature(n),t.addLayer(r.current),function(){r.current&&t.removeLayer(r.current)}}),[t]),(0,o.useEffect)((function(){if(r.current){var e=r.current.getSource();if(null===n)return i.current.getImage().setOpacity(0),void e.changed();var t=new K.Z((0,d.mi)([n.lon,n.lat]));e.getFeatureById("point").setGeometry(t),i.current.getImage().setOpacity(1),e.changed()}}),[t,n]),null},te=n(179),ne=n(8914),re=n(5893),oe=(0,i.Z)((function(e){return{root:{backgroundColor:"#e0e0e0",width:40},snackbarRoot:{overflow:"hidden",backgroundColor:"initial",boxShadow:"none"}}})),ie=function(e){var t,n,r=e.config,i=e.setCenter,u=e.setZoom,c=(oe(),(0,o.useState)("")),s=c[0],d=c[1];return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(l.ZP,{placement:"left",title:null!==(t=null===r||void 0===r||null===(n=r.translations)||void 0===n?void 0:n.MAP_MY_LOCATION_TOOLTIP)&&void 0!==t?t:"",children:(0,re.jsx)(a.Z,{size:"small",onClick:function(){navigator.geolocation.getCurrentPosition((function(e){var t=Math.floor(Math.min(20,Math.max(1,Math.log2(591657550/e.coords.accuracy)-2)));i((0,Y.mi)([e.coords.longitude,e.coords.latitude])),u(t)}),(function(e){return d(e.message)}))},children:(0,re.jsx)(te.Z,{})})}),s&&(0,re.jsx)(ne.Z,{error:s,setError:d})]})},ae=(0,i.Z)((function(e){return{root:(0,r.Z)({},e.breakpoints.down("xs"),{display:"none"})}})),le=function(e){var t,n,r=e.config,o=e.zoom,i=ae();return null!==r&&void 0!==r&&r.map.zoom.enabled?(0,re.jsx)(l.ZP,{placement:"left",title:null!==(t=null===r||void 0===r||null===(n=r.translations)||void 0===n?void 0:n.MAP_ZOOM_LEVEL_TOOLTIP)&&void 0!==t?t:"",children:(0,re.jsx)(a.Z,{size:"small",className:i.root,children:Math.floor(o)})}):null},ue=n(282),ce=n(4837),se=n(3957),de=n(64),fe=(0,i.Z)((function(e){return{root:(0,r.Z)({backgroundColor:"#e0e0e0",width:40},e.breakpoints.down("xs"),{display:"none"})}})),me=function(e){var t=e.config,n=e.setZoom,r=fe();return null!==t&&void 0!==t&&t.map.zoom.enabled?(0,re.jsxs)(ce.Z,{orientation:"vertical",variant:"outlined",size:"small",className:r.root,children:[(0,re.jsx)(ue.Z,{onClick:function(){return n((function(e){return e+1}))},children:(0,re.jsx)(se.Z,{})}),(0,re.jsx)(ue.Z,{onClick:function(){return n((function(e){return e-1}))},children:(0,re.jsx)(de.Z,{})})]}):null},ge=n(9003),ve=n(1846),pe=n(7162),we=n(553),he=n(4436),Ze=n(1195),xe=(0,i.Z)((function(e){return{root:{padding:e.spacing(2)},content:{padding:e.spacing(2)}}})),ye=function(e){var t,n,r,i,u,c=e.config,s=e.provider,d=e.setProvider,f=xe(),m=(0,o.useState)(null),g=m[0],v=m[1],p=null!==(t=null===c||void 0===c||null===(n=c.map)||void 0===n?void 0:n.providers)&&void 0!==t?t:[];return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(l.ZP,{placement:"left",title:null!==(r=null===c||void 0===c||null===(i=c.translations)||void 0===i?void 0:i.MAP_BASEMAP_TOOLTIP)&&void 0!==r?r:"",children:(0,re.jsx)(a.Z,{size:"small",onClick:function(e){return v(e.currentTarget)},children:(0,re.jsx)(Ze.Z,{})})}),(0,re.jsx)(ge.ZP,{className:f.root,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},open:null!==g,anchorEl:g,onClose:function(){return v(null)},children:(0,re.jsx)(he.Z,{component:"fieldset",className:f.content,children:(0,re.jsx)(pe.Z,{value:null!==(u=null===s||void 0===s?void 0:s.name)&&void 0!==u?u:"",onChange:function(e){v(null);var t=p.find((function(t){return t.name===e.target.value}));d(null!==t&&void 0!==t?t:null)},children:p.map((function(e){return(0,re.jsx)(we.Z,{value:e.name,label:e.name,control:(0,re.jsx)(ve.Z,{})},e.name)}))})})})]})},je=n(2318),be=n(8362),Ie=(0,i.Z)((function(e){return{root:{padding:e.spacing(2)},content:{padding:e.spacing(2),maxWidth:600}}})),Oe=function(e){var t,n,r=e.config,i=e.provider,u=Ie(),c=(0,o.useState)(null),s=c[0],d=c[1];return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(l.ZP,{placement:"left",title:null!==(t=null===r||void 0===r||null===(n=r.translations)||void 0===n?void 0:n.MAP_ATTRIBUTIONS_TOOLTIP)&&void 0!==t?t:"",children:(0,re.jsx)(a.Z,{size:"small",onClick:function(e){return d(e.currentTarget)},children:(0,re.jsx)(be.Z,{})})}),(0,re.jsx)(ge.ZP,{className:u.root,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},open:null!==s,anchorEl:s,onClose:function(){return d(null)},children:null!==i&&(0,re.jsx)(je.Z,{className:u.content,children:(0,re.jsx)("span",{dangerouslySetInnerHTML:{__html:i.attributions}})})})]})},Pe=n(6644),Se=n(2945),ke=n(2863),ze=(0,i.Z)((function(e){var t;return{root:{position:"absolute",left:0,bottom:0,transform:"scale(1)",transformOrigin:"bottom left",transition:"transform 0.2s ease-in-out"},rootFullscreen:{zIndex:100,width:"100%",height:"100vh"},rootWindow:(t={zIndex:200,margin:e.spacing(2)},(0,r.Z)(t,e.breakpoints.up("xs"),{width:"calc(100% - ".concat(e.spacing(11),"px)"),height:220}),(0,r.Z)(t,"".concat(e.breakpoints.up("xs")," and (orientation: landscape)"),{maxWidth:"50%",maxHeight:"50%"}),(0,r.Z)(t,e.breakpoints.up("sm"),{width:400,height:300}),(0,r.Z)(t,e.breakpoints.up("lg"),{width:"34%",height:"40%"}),(0,r.Z)(t,"& .ol-viewport",{backgroundColor:"#eeeeee",borderRadius:e.shape.borderRadius}),t),rootMinimized:{transform:"scale(0)"},rootStreetviewBottomMapTop:{zIndex:100,width:"100%",height:"40vh",position:"absolute",left:0,top:0},rootStreetviewTopMapBottom:{zIndex:100,width:"100%",height:"40vh",position:"absolute",left:0,bottom:0},controls:{display:"flex",flexDirection:"column",position:"absolute",bottom:0,right:0,zIndex:110,margin:e.spacing(2),"& > button, & > div":{marginTop:e.spacing(1)}},controlsWindow:{},controlsFullscreen:{},map:{width:"100%",height:"100%","& > button":{marginTop:e.spacing(1)},"& .ol-scale-bar":(0,r.Z)({top:"auto",right:e.spacing(9),bottom:e.spacing(1.5),left:"auto"},e.breakpoints.down("xs"),{display:"none"})},closed:{zIndex:200,margin:e.spacing(2),transform:"scale(0)",transition:"transform 0.2s ease-in-out"},closedMinimized:{transform:"scale(1)"}}})),Ae=function(e){var t,n,r=ze(),i=(0,o.useContext)(g.ZP).config,Z=(0,o.useContext)(v.Z),x=Z.layout,y=Z.setLayout,j=(0,o.useContext)(p.Z),b=j.center,O=j.setCenter,P=j.zoom,S=j.setZoom,k=j.provider,z=j.setProvider,A=j.searchPlace,E=j.asset,T=j.fitPoints,C=(0,o.useContext)(w.ZP),M=C.selected,L=C.setSelected,N=C.timeline,R=C.hlookat,V=C.fov,F=(0,o.useRef)(null),B=(0,o.useState)(null),G=B[0],W=B[1],U=(0,h.Z)(),q=x.window===ke.S.Map,X=!q&&x.minimized;x.window===ke.S.StreetviewOnly&&(X=!0);var K=[r.root,q?r.rootFullscreen:r.rootWindow,X?r.rootMinimized:""].join(" "),Q=[r.controls,q?r.controlsFullscreen:r.controlsWindow].join(" "),Y=[r.root,r.closed,X?r.closedMinimized:""].join(" ");x.window===ke.S.StreetviewBottomMapTop&&(K=[r.rootStreetviewBottomMapTop].join(" ")),x.window===ke.S.StreetviewTopMapBottom&&(K=[r.rootStreetviewTopMapBottom].join(" "));var H=function(){y((function(e){return{window:e.window,minimized:!e.minimized}}))};return(0,o.useEffect)((function(){if(null!==G&&null!==M){G.updateSize();var e=G.getView(),t=(0,d.mi)([M.lon,M.lat]);e.setCenter(t)}}),[q]),(0,o.useEffect)((function(){if(null!==G){var e=G.getView();b!==e.getCenter()&&e.setCenter(b),P!==e.getZoom()&&e.setZoom(P),P>e.getMaxZoom()&&S(e.getMaxZoom())}}),[P,b]),(0,o.useEffect)((function(){if(null!==G&&0!==T.length){var e=(0,f.hI)(T);G.getView().fit(e,{padding:[16,16,16,16],maxZoom:18})}}),[G,T]),(0,o.useEffect)((function(){if(null===i||null===G)return function(){};var e=null;i.map.scaleLine.enabled&&(e=new s.Z({bar:!0,units:null===i||void 0===i?void 0:i.map.scaleLine.units,steps:2,minWidth:80}),G.addControl(e));var t=G.getView();return t.setCenter((0,d.mi)(i.map.view.center)),t.setZoom(i.map.view.zoom),function(){null!==e&&G.removeControl(e)}}),[i,G]),(0,o.useEffect)((function(){if(null!==i&&null!==G&&null!==M&&M.id!==i.streetview.initial.id){var e=(0,d.mi)([M.lon,M.lat]),t=G.getView().calculateExtent();(0,f.b8)(t,e)||O(e)}}),[i,G,M]),(0,o.useEffect)((function(){var e,t=new u.Z({controls:[],layers:[],target:null!==(e=F.current)&&void 0!==e?e:void 0,view:new c.ZP({center:b,zoom:P,maxZoom:22})});return t.on("moveend",(function(e){var t=e.map.getView();O(t.getCenter()),S(t.getZoom())})),W(t),function(){t.setTarget(void 0),W(null)}}),[]),(0,o.useEffect)((function(){var e;null!==(e=F.current)&&void 0!==e&&e.parentElement&&(q?F.current.parentElement.style.height=U:F.current.parentElement.style.removeProperty("height"))}),[q,U]),(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)("div",{className:K,children:[(0,re.jsx)("div",{className:r.map,ref:F}),(0,re.jsx)(I,{map:G,provider:k}),(0,re.jsx)(_,{config:i,map:G,setSelected:L,timeline:N}),(0,re.jsx)($,{map:G,searchPlace:A}),(0,re.jsx)(ee,{map:G,asset:E}),(0,re.jsx)(J,{map:G,selected:M,setSelected:L,hlookat:R,fov:V}),(0,re.jsxs)("div",{className:Q,children:[(0,re.jsx)(ye,{config:i,provider:k,setProvider:z}),(0,re.jsx)(ie,{config:i,setCenter:O,setZoom:S}),(0,re.jsx)(le,{config:i,zoom:P}),(0,re.jsx)(me,{config:i,setZoom:S}),(0,re.jsx)(Oe,{config:i,provider:k})]}),!q&&[ke.S.Map,ke.S.Streetview].includes(x.window)&&(0,re.jsx)(Se.Z,{config:i,onClick:H}),!q&&[ke.S.Map,ke.S.Streetview].includes(x.window)&&(0,re.jsx)(Pe.Z,{config:i,onClick:function(){y((function(e){return{window:e.window===ke.S.Map?ke.S.Streetview:ke.S.Map,minimized:e.minimized}}))}})]}),x.window!==ke.S.StreetviewOnly&&(0,re.jsx)("div",{className:Y,children:(0,re.jsx)(l.ZP,{placement:"left",title:null!==(t=null===i||void 0===i||null===(n=i.translations)||void 0===n?void 0:n.MAP_MAXIMIZE_TOOLTIP)&&void 0!==t?t:"",children:(0,re.jsx)(a.Z,{size:"small",color:"primary",onClick:H,children:(0,re.jsx)(m.Z,{})})})})]})}}}]);