(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7923:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ie}});var o=n(7294),r=n(1120),i=n(5152),a=n(4562),l=n(7155),s=n(8319),c=n(4013),u=n(8920),d=n(3457),p=n(5893),f=(0,r.Z)((function(t){return{root:{position:"absolute",top:0,left:0,zIndex:200,margin:t.spacing(2)}}})),v=function(t){var e=f(),n=(0,u.Z)(),r=(0,d.Z)(n.breakpoints.down("xs")),i=(0,o.useContext)(s.ZP).config;if(null===i)return null;var a=i.general.logo,l=a.enabled?a.imageUrl:"",c=a.enabledSmall?a.imageUrlSmall:"",v=r?c:l;return""===v?null:(0,p.jsx)("a",{className:e.root,href:a.linkUrl,target:a.linkTarget,style:{pointerEvents:""===a.linkUrl?"none":"auto"},children:(0,p.jsx)("img",{src:v,alt:""})})},h=n(2809),m=n(3758),g=n(868),w=n(1267),x=n(4586),b=n(4564),y=n.n(b),k=n(8943),Z=n(7569),_=n(1979),E=n(6569),j=n(318),S=n(3789),C=n(266),P=n(809),T=n.n(P),O=n(8760);function A(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var I=function(){var t=(0,C.Z)(T().mark((function t(e,n){var o,r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=n.krpano,r=null;case 2:if(null!==r){t.next=8;break}return r=o.get("hotspot[".concat(e,"]")),t.next=6,new Promise((function(t){return window.requestAnimationFrame(t)}));case 6:t.next=2;break;case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),z=function(t,e){var n=0,o=(t-e+360)%360;if(o<180)n=o;else{if(!(o>=180&&o<=360))return 1;n=o-360}return 0===n?1:n},N=function(t){return t.id.slice(0,-10)},R=function(t,e,n,o){var r=o.krpano,i=(o.config,r.get("view.hlookat")),a=r.get("view.vlookat"),l=r.get("stagewidth")/2,s=.85*r.get("stageheight"),c=r.screentosphere(l,s),u=(c.x,c.y),d=(0,O.H5)(e.lat,e.lon,n.lat,n.lon),p=i-z(d,e.heading),f=0,v=0;if(u<a){var h=a-u+60;h>90&&(h=90),f=h-a,v=a}else f=60-a,v=u;var m=r.get("hotspot[".concat(t,"]"));null!==m&&(m.ath=i,m.atv=v,m.rx=f,m.rz=p)},M=function(t){var e=t.krpano,n=t.config,r=t.selected,i=t.setSelected,a=t.nearby,l=t.loaded,s=t.hotspotsVisible,c=t.setHotspotsVisible,u=t.setHlookatNoEffect,d=(0,o.useRef)([]),p=(0,o.useRef)(Date.now()),f=function(t,e){if(!(Date.now()-p.current<15)){var n=a.find((function(e){return e.id===t.id}));if(n){if(e){var o,l=(null!==(o=null===r||void 0===r?void 0:r.heading)&&void 0!==o?o:0)-n.heading;u((function(t){return t+l}))}i(n),p.current=Date.now()}}},v=function(){var t,o,l;if(r&&n&&0!==a.length){var s=null!==(t=null===n||void 0===n?void 0:n.streetview.mouse.distanceMin)&&void 0!==t?t:0,c=null!==(o=null===n||void 0===n?void 0:n.streetview.mouse.distanceMax)&&void 0!==o?o:0,d=e.screentosphere(e.mouse.x,e.mouse.y),p=d.x,f=d.y,v=a.filter((function(t){var e=(0,O.Lb)(r.lat,r.lon,t.lat,t.lon);return e>=s&&e<=c})).map((function(t){var e=t.height-n.streetview.cameraHeight,o=(0,O.H5)(r.lat,r.lon,t.lat,t.lon)-r.heading,i=(0,O.S3)(r.lat,r.lon,r.height,t.lat,t.lon,e);return{streetview:t,h:o,v:i,dist:(0,O.Lb)(p,f,o,i)}}));v.sort((function(t,e){return t.dist-e.dist}));var h=v[0].streetview,m=(null!==(l=null===r||void 0===r?void 0:r.heading)&&void 0!==l?l:0)-h.heading;u((function(t){return t+m})),i(h)}};return(0,o.useEffect)((function(){if(null===n||null===e||null===r||null===a||!1===l||!1===s)return function(){};var t="layer-".concat((0,x.Z)()),o=function(t,e){var n=N(t),o=[].concat((0,S.Z)(e),[t]).filter((function(t){return n===N(t)}));o.sort((function(t,e){return t.id.localeCompare(e.id)}));var r=o.findIndex((function(e){return e.id===t.id}));return{prev:o[r-1],next:o[r+1]}}(r,a),i=o.prev,c=o.next,u=function(t,e,n){n.krpano;var o,r,i=n.config;if(!i.streetview.hotspot.enabled)return[];var a=null!==(o=null===i||void 0===i?void 0:i.streetview.hotspot.distanceMin)&&void 0!==o?o:0,l=null!==(r=null===i||void 0===i?void 0:i.streetview.hotspot.distanceMax)&&void 0!==r?r:0;return t.filter((function(t){var n=(0,O.Lb)(e.lat,e.lon,t.lat,t.lon);return n>=a&&n<=l})).map((function(t){return t.id}))}(a,r,{krpano:e,config:n});a.forEach((function(o){if(u.includes(o.id)){var i=function(t,e){var n,o=e.krpano,r=e.config,i="hotspot-".concat((0,x.Z)());o.call("addhotspot(".concat(i,")"));var a=o.get("hotspot[".concat(i,"]"));return a.url="images/textfield.swf",a.autowidth=!1,a.autoheight=!1,a.handcursor=!0,a.capture=!1,a.align="center",a.distorted=!0,a.background=!0,a.width=r.streetview.hotspot.width,a.height=r.streetview.hotspot.width,a.roundedge=r.streetview.hotspot.width/2,a.backgroundcolor=12031,a.backgroundalpha=.5,a.border=!1,o.call("showtextperm(".concat(escape(null!==(n=t.label)&&void 0!==n?n:""),", STREETVIEW_HOTSPOT_POPUP_DESC, 0, 0, 0, ").concat(i,"-label)")),I("".concat(i,"-label"),{krpano:o}).then((function(t){t.enabled=!0,t.handcursor=!0,t.distorted=!0})),i}(o,{krpano:e,config:n});!function(t,e,n,o){var r=o.krpano,i=o.config,a=n.height-i.streetview.cameraHeight,l=(0,O.H5)(e.lat,e.lon,n.lat,n.lon)-e.heading,s=(0,O.S3)(e.lat,e.lon,e.height,n.lat,n.lon,a),c=(0,O.Lb)(n.lat,n.lon,e.lat,e.lon),u=Math.atan(c/(e.height-a))*(180/Math.PI),d=1/(c/10*2),p=r.get("hotspot[".concat(t,"]"));null!==p&&(p.ath=l,p.atv=s,p.rx=u,p.scale=d>2.5?2.5:d,I("".concat(t,"-label"),{krpano:r}).then((function(t){t.ath=l,t.atv=s,t.scale=p.scale})))}(i,r,o,{krpano:e,config:n});var a=e.get("hotspot[".concat(i,"]"));a.layer=t,a.id=o.id,a.onclick=function(){return f(e.get("hotspot[".concat(i,"]")),!0)},I("".concat(i,"-label"),{krpano:e}).then((function(t){t.onclick=function(){return f(e.get("hotspot[".concat(i,"]")),!0)}}))}})),d.current=[];var p=function(t,e,n){var o,r,i=n.krpano,a=n.config,l=n.prev,s=n.next;if(!a.streetview.arrow.enabled)return[];var c=null!==(o=null===a||void 0===a?void 0:a.streetview.arrow.distanceMin)&&void 0!==o?o:0,u=null!==(r=null===a||void 0===a?void 0:a.streetview.arrow.distanceMax)&&void 0!==r?r:0,d=t.map((function(t){var n=i.get("view.hlookat"),o=(0,O.H5)(e.lat,e.lon,t.lat,t.lon);return[n-z(o,e.heading),(0,O.Lb)(e.lat,e.lon,t.lat,t.lon),t]})).filter((function(t){var e=(0,j.Z)(t,3),n=(e[0],e[1]),o=e[2];return(null===l||void 0===l?void 0:l.id)===o.id||(null===s||void 0===s?void 0:s.id)===o.id||n>=c&&n<=u}));d.sort((function(t,e){return t[1]-e[1]}));var p,f=d.filter((function(t){var e=(0,j.Z)(t,3),n=(e[0],e[1],e[2]);return n.id===(null===l||void 0===l?void 0:l.id)||n.id===(null===s||void 0===s?void 0:s.id)})),v=A(d);try{var h=function(){var t=(0,j.Z)(p.value,3),e=t[0],n=t[1],o=t[2];f.find((function(t){var n=(0,j.Z)(t,1)[0];return 180-Math.abs(Math.abs((0,O.LW)(n)-(0,O.LW)(e))-180)<a.streetview.arrow.angleMax}))||f.push([e,n,o])};for(v.s();!(p=v.n()).done;)h()}catch(m){v.e(m)}finally{v.f()}return f.map((function(t){var e=(0,j.Z)(t,3);return e[0],e[1],e[2].id}))}(a,r,{krpano:e,config:n,prev:i,next:c});if(a.forEach((function(o){if(p.includes(o.id)){var a=function(t,e){var n=e.krpano,o=(e.config,e.prev),r=e.next,i="arrow-".concat((0,x.Z)());n.call("addhotspot(".concat(i,")"));var a=t.id===(null===o||void 0===o?void 0:o.id)||t.id===(null===r||void 0===r?void 0:r.id),l=n.get("hotspot[".concat(i,"]"));l.width=100,l.height=120,l.renderer="html",l.edge="bottom",l.distorted=!0,l.capture=!1,l.crop="0|0|".concat(100,"|").concat(120),l.inverserotation=!0,l.url="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",l.zorder=a?20:10,l.keep=!0;var s=a?"#212121":"#FFECB3";return l.onloaded=function(){var t='\n      <svg width="'.concat(100,'" height="').concat(60,'">\n        <path\n          fill="#FFECB3"\n          stroke="').concat(s,'"\n          stroke-width="1"\n          d="M97.44,43.82L56.18,2.56a8.75,8.75,0,0,0-12.37,0h0L2.56,43.8A8.75,8.75,0,0,0,14.94,56.18l35-35L85.05,56.2A8.75,8.75,0,1,0,97.44,43.82h0Z"\n        />\n      </svg>\n    ');l.sprite.innerHTML=t},i}(o,{krpano:e,config:n,prev:i,next:c});R(a,r,o,{krpano:e,config:n}),d.current.push((function(){R(a,r,o,{krpano:e,config:n})}));var l=e.get("hotspot[".concat(a,"]"));l.layer=t,l.id=o.id,l.onclick=function(){return f(e.get("hotspot[".concat(a,"]")))}}})),n.streetview.mouse.enabled){var h=function(t){var e=t.krpano,n=t.config,o="hotspot-mouse";e.call("addhotspot(hotspot-mouse)");var r=e.get("hotspot[".concat(o,"]"));return r.devices="mouse",r.type="text",r.html="",r.css="font-size:80px; text-align:center;",r.vcenter=!0,r.width=n.streetview.mouse.width,r.height=n.streetview.mouse.width,r.scale=.5,r.bgalpha=.5,r.bgroundedge=n.streetview.mouse.width/2,r.oversampling=2,r.mipmapping=!0,r.zorder=1,r.distorted=!0,r.depth=0,r.depthbuffer=!0,r.torigin="world",r.rotationorder="xyz",r.rx=-90,r.capture=!1,r.handcursor=!1,r.autoalpha=!0,r.camera_height=100*n.streetview.cameraHeight,r.onloaded="hotspot_mouse_position();",o}({krpano:e,config:n}),m=e.get("hotspot[".concat(h,"]"));m.layer=t,m.onclick=v}return function(){e.get("hotspot").getArray().filter((function(e){return e.layer===t})).forEach((function(t){e.call("removehotspot(".concat(t.name,")")),e.call("removehotspot(".concat(t.name,"-label)"))}))}}),[n,e,r,a,l,s]),(0,o.useEffect)((function(){if(null===e)return function(){};var t=e.get("events").createItem("hotspotsEvents");return t.keep=!0,t.onviewchanged=function(){d.current.forEach((function(t){return t()}))},function(){e.get("events").removeItem("hotspotsEvents")}}),[e]),(0,o.useEffect)((function(){var t=function(t){t.ctrlKey&&t.shiftKey&&"KeyH"===t.code&&c((function(t){return!t}))};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[]),null},D=function(t){var e=t.krpano,n=t.config,r=t.selected,i=t.asset,a=t.loaded;return(0,o.useEffect)((function(){var t;if(null===n||null===e||null===r||null===i||!1===a)return function(){};var o="asset-".concat((0,x.Z)());e.call("addhotspot(".concat(o,")"));var l=e.get("hotspot[".concat(o,"]"));l.url="images/textfield.swf",l.autowidth=!1,l.autoheight=!1,l.handcursor=!1,l.capture=!1,l.border=!0,l.width=20,l.height=20,l.backgroundcolor="0xf44336",l.bordercolor="0xffffff",l.borderwidth=2;var s=null!==i.alt?i.alt-n.streetview.cameraHeight:r.height,c=(0,O.H5)(r.lat,r.lon,i.lat,i.lon)-r.heading,u=(0,O.S3)(r.lat,r.lon,r.height,i.lat,i.lon,s);return l.ath=c,l.atv=u,e.call("showtextperm(".concat(escape(null!==(t=i.label)&&void 0!==t?t:""),", STREETVIEW_HOTSPOT_POPUP_DESC, 0, 0, 0, ").concat(o,"-label)")),I("".concat(o,"-label"),{krpano:e}).then((function(t){t.ath=c,t.atv=u,t.scale=1,t.oy=-l.height})),function(){e.call("removehotspot(".concat(o,")")),e.call("removehotspot(".concat(o,"-label)"))}}),[n,e,r,i,a]),null},H=n(9302),U=n(282),F=n(4837),B=n(7812),V=n(6617),W=n(9895),Y=n(4845),q=n(5477),G=n(1449),K=n(4884),X=n(9875),Q=n(6735),J=n(6652),$=n(6054),tt=n(9039),et=n(3340),nt=n(796),ot=n(4693),rt=n(6783),it=function(t){return t.id.slice(0,-10)},at=function(t){return Math.round(100*(t+Number.EPSILON))/100},lt=(0,r.Z)((function(t){return{root:{backgroundColor:"#e0e0e0",position:"absolute",left:"50%",top:0,transform:"translate(-50%, 0)",margin:t.spacing(2)},popover:{zIndex:200,width:300},popoverContent:{padding:t.spacing(2),marginTop:t.spacing(1)},playButton:{transition:"transform 0.5s ease"},playButtonReverse:{transform:"scaleX(-1)"},playSpeed:{display:"flex",flexDirection:"row",alignItems:"center"},playerSpeedSlider:{marginLeft:t.spacing(2),marginRight:t.spacing(1)},tourPosition:{display:"flex",flexDirection:"row",alignItems:"center"},tourPositionLoading:{width:"24px !important",height:"24px !important"},tourPositionSlider:{marginLeft:t.spacing(2),marginRight:t.spacing(1)}}})),st=function(t){var e,n,r,i,a,l,s,c,u,d,f,v,h,m,w=t.config,x=t.selected,b=t.setSelected,y=t.next,k=lt(),Z=(0,o.useState)(!1),_=Z[0],E=Z[1],j=(0,o.useState)(null),S=j[0],P=j[1],O=(0,o.useState)(1),A=O[0],L=O[1],I=(0,o.useState)(1),z=I[0],N=I[1],R=(0,o.useState)(null),M=R[0],D=R[1],st=(0,o.useState)(null),ct=st[0],ut=st[1],dt=(0,o.useRef)({}),pt=(0,H.Z)((function(t){return function(t){if(null!==x&&null!==ct&&void 0!==ct){var e=it(x),n=ct[e];if(n){var o=n[Math.round(t/2*98)];o&&b(o)}}}(t)}),1e3);if((0,o.useEffect)((function(){w&&w.general.flow.enabled&&(w.general.flow.initial?setTimeout((function(){E(!0)}),1e3*w.general.flow.waitTime):E(!1))}),[w]),(0,o.useEffect)((function(){if(!w||!_)return function(){};if(!w.general.flow.enabled)return function(){};var t=(null===w||void 0===w?void 0:w.general.flow.speed)/A*1e3,e=setTimeout((function(){y(z)}),t);return function(){clearTimeout(e)}}),[w,y,_,A,z]),(0,o.useEffect)((function(){w&&S&&!ct&&(0,C.Z)(T().mark((function t(){var e,n,o;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(w.streetview.dataUrl,"/tours-outline.json"));case 3:return e=t.sent,t.next=6,e.json();case 6:for(o in n=t.sent)dt.current[o]=(0,G.Tu)(n[o].map((function(t){return[t.lon,t.lat]})));ut(n),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0),ut(void 0),dt.current={};case 16:case"end":return t.stop()}}),t,null,[[0,11]])})))()}),[w,S,ct]),(0,o.useEffect)((function(){if(S&&ct&&x){var t=it(x),e=dt.current[t];e&&D((function(t){var n,o=[x.lon,x.lat],r=(0,K.Z)(e,o,{units:"meters"}),i=at((null!==(n=r.properties.index)&&void 0!==n?n:0)/49);return at(Math.abs(i-(null!==t&&void 0!==t?t:0)))>.01?i:t}))}}),[S,ct,x]),null===w||void 0===w||!w.general.flow.enabled)return null;var ft=[k.playButton,-1===z?k.playButtonReverse:""].join(" ");return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(F.Z,{variant:"outlined",size:"small",className:k.root,children:[(0,p.jsx)(g.ZP,{placement:"left",title:null!==(e=null===w||void 0===w||null===(n=w.translations)||void 0===n?void 0:n.STREETVIEW_FLOW_PREVIOUS_TOOLTIP)&&void 0!==e?e:"",children:(0,p.jsx)(U.Z,{onClick:function(){return y(-1)},children:(0,p.jsx)(X.Z,{})})}),(0,p.jsxs)(U.Z,{onClick:function(){return E((function(t){return!t}))},children:[!_&&(0,p.jsx)(g.ZP,{title:null!==(r=null===w||void 0===w||null===(i=w.translations)||void 0===i?void 0:i.PLAY_START_TOOLTIP)&&void 0!==r?r:"",children:(0,p.jsx)(J.Z,{className:ft})}),_&&(0,p.jsx)(g.ZP,{title:null!==(a=null===w||void 0===w||null===(l=w.translations)||void 0===l?void 0:l.PLAY_STOP_TOOLTIP)&&void 0!==a?a:"",children:(0,p.jsx)($.Z,{})})]}),(0,p.jsx)(g.ZP,{placement:"right",title:null!==(s=null===w||void 0===w||null===(c=w.translations)||void 0===c?void 0:c.STREETVIEW_FLOW_NEXT_TOOLTIP)&&void 0!==s?s:"",children:(0,p.jsx)(U.Z,{onClick:function(){return y(1)},children:(0,p.jsx)(Q.Z,{})})}),(0,p.jsxs)(U.Z,{size:"small",onClick:function(t){return P((function(e){return e?null:t.currentTarget}))},children:[null===S&&(0,p.jsx)(tt.Z,{}),null!==S&&(0,p.jsx)(et.Z,{})]})]}),(0,p.jsx)(V.Z,{className:k.popover,open:null!==S,anchorEl:S,children:(0,p.jsxs)(W.Z,{className:k.popoverContent,children:[(0,p.jsxs)("div",{className:k.playSpeed,children:[(0,p.jsx)(g.ZP,{title:null!==(u=null===w||void 0===w||null===(d=w.translations)||void 0===d?void 0:d.PLAY_SPEED_TOOLTIP)&&void 0!==u?u:"",children:(0,p.jsx)(ot.Z,{})}),(0,p.jsx)(Y.Z,{className:k.playerSpeedSlider,valueLabelDisplay:"auto",min:.25,max:2,step:.25,value:A,onChange:function(t,e){return L(Array.isArray(e)?e[0]:e)}}),(0,p.jsx)(g.ZP,{title:null!==(f=null===w||void 0===w||null===(v=w.translations)||void 0===v?void 0:v.PLAY_DIRECTION_TOOLTIP)&&void 0!==f?f:"",children:(0,p.jsx)(B.Z,{onClick:function(){return N((function(t){return-1*t}))},children:(0,p.jsx)(nt.Z,{})})})]}),(0,p.jsxs)("div",{className:k.tourPosition,children:[null===ct&&(0,p.jsx)("div",{className:k.tourPositionLoading,children:(0,p.jsx)(q.Z,{className:k.tourPositionLoading})}),null!==ct&&(0,p.jsx)(g.ZP,{title:null!==(h=null===w||void 0===w||null===(m=w.translations)||void 0===m?void 0:m.TOUR_POSITION_TOOLTIP)&&void 0!==h?h:"",children:(0,p.jsx)(rt.Z,{})}),(0,p.jsx)(Y.Z,{className:k.tourPositionSlider,min:0,max:1,step:.02,disabled:null===ct||void 0===ct,value:null!==M&&void 0!==M?M:0,onChange:function(t,e){var n=Array.isArray(e)?e[0]:e;D(n),pt(n)}})]})]})})]})},ct=n(3957),ut=n(64),dt=(0,r.Z)((function(t){return{root:{backgroundColor:"#e0e0e0",width:40}}})),pt=function(t){var e=t.krpano,n=dt(),o=function(t){null!==e&&(e.set("fov_moveforce",t),setTimeout((function(){e.set("fov_moveforce",0)}),75))};return(0,p.jsxs)(F.Z,{orientation:"vertical",variant:"outlined",size:"small",className:n.root,children:[(0,p.jsx)(U.Z,{onClick:function(){return o(-1)},children:(0,p.jsx)(ct.Z,{})}),(0,p.jsx)(U.Z,{onClick:function(){return o(1)},children:(0,p.jsx)(ut.Z,{})})]})},ft=(0,r.Z)((function(t){return{}})),vt=function(t){var e,n,o=t.config,r=t.selected,i=t.localeSelected;ft();if(null===r)return null;var a=null!==(e=null===o||void 0===o||null===(n=o.translations)||void 0===n?void 0:n.STREETVIEW_CAPTURED_DATE_LABEL)&&void 0!==e?e:"",l=new Date(Date.parse(r.date)),s=60*l.getTimezoneOffset()*1e3,c=60*(new Date).getTimezoneOffset()*1e3,u=new Date(+l+s-c),d=null!==o&&void 0!==o&&o.streetview.captureDate.time?"short":void 0,f=new Intl.DateTimeFormat(i,{dateStyle:"short",timeStyle:d}).format(u);return(0,p.jsx)(w.Z,{size:"small",label:"".concat(a,": ").concat(f)})},ht=n(6644),mt=n(2945),gt=n(2863),wt=(0,r.Z)((function(t){var e;return{root:{position:"absolute",left:0,bottom:0,transform:"scale(1)",transformOrigin:"bottom left",transition:"transform 0.2s ease-in-out"},rootFullscreen:{zIndex:100,width:"100%",height:"100vh"},rootWindow:(e={zIndex:200,margin:t.spacing(2)},(0,h.Z)(e,t.breakpoints.up("xs"),{width:"calc(100% - ".concat(t.spacing(11),"px)"),height:220}),(0,h.Z)(e,"".concat(t.breakpoints.up("xs")," and (orientation: landscape)"),{maxWidth:"50%",maxHeight:"50%"}),(0,h.Z)(e,t.breakpoints.up("sm"),{width:400,height:300}),(0,h.Z)(e,t.breakpoints.up("lg"),{width:"34%",height:"40%"}),e),rootMinimized:{transform:"scale(0)"},rootStreetviewBottomMapTop:{zIndex:100,width:"100%",height:"60vh",position:"absolute",left:0,bottom:0},rootStreetviewTopMapBottom:{zIndex:100,width:"100%",height:"60vh",position:"absolute",left:0,top:0},controls:{display:"flex",flexDirection:"column",alignItems:"flex-end",position:"absolute",bottom:0,right:0,zIndex:110,margin:t.spacing(2),pointerEvents:"none","& > button, & > div":{pointerEvents:"auto",marginTop:t.spacing(1)}},controlsWindow:{},controlsFullscreen:{},closed:{zIndex:200,margin:t.spacing(2),transform:"scale(0)",transition:"transform 0.2s ease-in-out"},closedMinimized:{transform:"scale(1)"},streetview:{width:"100%",height:"100%"},streetviewWindow:{"& > div":{borderRadius:t.shape.borderRadius}}}})),xt=function(t){var e,n,r,i,a=wt(),l=(0,o.useContext)(s.ZP),u=l.config,d=l.localeSelected,f=(0,o.useContext)(c.Z),v=f.layout,h=f.setLayout,b=(0,o.useContext)(Z.ZP),j=b.selected,S=b.setSelected,C=b.setHlookatNoEffect,P=b.setVlookatNoEffect,T=b.setFovNoEffect,O=b.nearby,A=b.next,L=b.hotspotsVisible,I=b.setHotspotsVisible,z=(0,o.useContext)(_.Z).asset,N=(0,E.Z)(),R=(0,o.useRef)(null),H=(0,o.useState)(null),U=H[0],F=H[1],B=(0,o.useState)(!1),V=B[0],W=B[1],Y=(0,o.useRef)(!1),q=v.window===gt.S.Streetview;v.window===gt.S.StreetviewOnly&&(q=!0);var G=!q&&v.minimized,K=["streetview",a.root,q?a.rootFullscreen:a.rootWindow,G?a.rootMinimized:""].join(" "),X=[a.controls,q?a.controlsFullscreen:a.controlsWindow].join(" "),Q=[a.root,a.closed,G?a.closedMinimized:""].join(" "),J=[a.streetview,q?"":a.streetviewWindow].join(" ");v.window===gt.S.StreetviewBottomMapTop&&(K=[a.rootStreetviewBottomMapTop].join(" ")),v.window===gt.S.StreetviewTopMapBottom&&(K=[a.rootStreetviewTopMapBottom].join(" "));var $=function(){h((function(t){return{window:t.window,minimized:!t.minimized}}))};return(0,o.useEffect)((function(){if(null!==u&&null!==U&&null!==j){Y.current=!0,W(!1);var t=u.streetview.fov.initial,e=u.streetview.hlookat.initial,n=u.streetview.vlookat.initial,o='\n      <view\n        hlookat="'.concat(e,'"\n        vlookat="').concat(n,'"\n        vlookatmin="').concat(u.streetview.vlookat.min,'"\n        vlookatmax="').concat(u.streetview.vlookat.max,'"\n        fovtype="').concat(u.streetview.fov.type,'"\n        fov="').concat(t,'"\n        fovmin="').concat(u.streetview.fov.min,'"\n        fovmax="').concat(u.streetview.fov.max,'"\n        limitview="').concat(u.streetview.limitview,'"\n      />\n      <control keybfovchange="0.3" keybspeed="1.0" keybaccelerate="0.3" />\n    '),r="".concat(u.streetview.tilesUrl,"/").concat(j.id),i='\n      <image>\n        <sphere\n          url="'.concat(r,'/%l_%h_%v.jpg"\n          multires="').concat(j.tileFormat,'"\n        />\n      </image>\n    '),a="\n      <krpano>\n        ".concat('\n  <textstyle name="STREETVIEW_HOTSPOT_POPUP_DESC"\n    font="Arial, Helvetica, sans-serif"\n    fontsize="14"\n    bold="true"\n    background="true"\n    backgroundcolor="0x000000"\n    backgroundalpha="0.667"\n    border="true"\n    borderwidth="2"\n    bordercolor="0xffffff"\n    roundedge="10"\n    textcolor="0xc0c0c0"\n    padding="6 10 6 10"\n    textalign="center"\n    yoffset="-5"\n  />\n\n  <textstyle name="STREETVIEW_ARROW_POPUP_DESC"\n    font="Arial, Helvetica, sans-serif"\n    fontsize="14"\n    bold="true"\n    background="true"\n    backgroundcolor="0x000000"\n    backgroundalpha="0.667"\n    border="true"\n    borderwidth="2"\n    bordercolor="0xffffff"\n    roundedge="10"\n    textcolor="0xc0c0c0"\n    padding="6 10 6 10"\n    textalign="center"\n    yoffset="-5"\n  />\n\n  <action name="showtextperm">\n    set(showtextperm_text, "");\n    set(showtextperm_clipping, false);\n\n    if("%2" != "null", ifnot(textstyle["%2"], trace("textstyle "%2" not found"); , set(showtextperm_style,"%2")); );\n\n    set(showtextperm_text, %1);\n\n    if("%6" != "null",\n    set(showtextperm_name, "%6");\n    ,\n    mul(id, random, 1000);\n    add(id, 1);\n    roundval(id);\n    txtadd(showtextperm_name, "text_", get(id));\n    );\n\n    set(showtextperm_atv, "%3");\n    set(showtextperm_ath, "%4");\n    if("%5" !== null, set(showtextperm_scale, "%5"));\n\n    if(showtextperm_text !== "" AND showtextperm_text !== "undefined" AND showtextperm_text !== null AND\n    showtextperm_text !== "null",\n    showtextperm_createnewtext();\n    )\n  </action>\n\n  <action name="showtextperm_createnewtext">\n    addhotspot(get(showtextperm_name));\n\n    copy(tfp, hotspot[get(showtextperm_name)]);\n    copy(tsp, textstyle[get(showtextperm_style)]);\n\n    if(tsp.edge !== null, copy(tsp_edge, tsp.edge), set(tsp_edge, "bottom"));\n    if(tsp.xoffset !== null, copy(tsp_xoffset, tsp.xoffset), set(tsp_xoffset, 0));\n    if(tsp.yoffset !== null, copy(tsp_yoffset, tsp.yoffset), set(tsp_yoffset, -3));\n\n    copy(tfp.edge, tsp_edge);\n    copy(tfp.ox, tsp_xoffset);\n    mul(tsp_yoffset, showtextperm_scale);\n    copy(tfp.oy, tsp_yoffset);\n    copy(tfp.ath, showtextperm_ath);\n    copy(tfp.atv, showtextperm_atv);\n    copy(tfp.scale, showtextperm_scale);\n\n    if(tsp.font !== null, copy(tsp_font, tsp.font), set(tsp_font, "Times"));\n    if(tsp.fontsize !== null, copy(tsp_fontsize, tsp.fontsize), set(tsp_fontsize, 12.0));\n    if(tsp.bold !== null, copy(tsp_bold, tsp.bold), set(tsp_bold, true));\n    if(tsp.italic !== null, copy(tsp_italic, tsp.italic), set(tsp_italic, false));\n    if(tsp.textcolor !== null, copy(tsp_textcolor, tsp.textcolor), set(tsp_textcolor, 0x000000));\n    if(tsp.textalign !== null, copy(tsp_textalign, tsp.textalign), set(tsp_textalign, "left"));\n\n    set(tfp_css, "");\n    tohex(tsp_textcolor, "#", 6);\n    txtadd(tfp_css, "font-family:",get(tsp_font),"; font-size:",get(tsp_fontsize),"px; color:",get(tsp_textcolor),"; ");\n    if(tsp_textalign != "none", txtadd(tfp_css, get(tfp_css), "text-align:",get(tsp_textalign),"; "));\n    if(tsp_bold, txtadd(tfp_css, "font-weight:bold; "));\n    if(tsp_italic, txtadd(tfp_css, "font-style:italic; "));\n    if(tsp.css !== null, txtadd(tfp_css, get(tsp.css)));\n    copy(tfp.css, tfp_css);\n\n    if(tsp.width !== null, copy(tfp.width, tsp.width));\n    if(tsp.height !== null, copy(tfp.height, tsp.height));\n    if(tsp.vcenter !== null, copy(tfp.vcenter, tsp.vcenter));\n    if(tsp.padding !== null, copy(tfp.padding, tsp.padding), set(tfp.padding,1));\n\n    if(tsp.background !== null, copy(tfp.background, tsp.background));\n    if(tsp.backgroundcolor !== null, copy(tfp.backgroundcolor, tsp.backgroundcolor));\n    if(tsp.backgroundalpha !== null, copy(tfp.backgroundalpha, tsp.backgroundalpha));\n    if(tsp.border !== null, copy(tfp.border, tsp.border), set(tfp.border,true));\n    if(tsp.bordercolor !== null, copy(tfp.bordercolor, tsp.bordercolor));\n    if(tsp.borderalpha !== null, copy(tfp.borderalpha, tsp.borderalpha));\n    if(tsp.borderwidth !== null, copy(tfp.borderwidth, tsp.borderwidth));\n    if(tsp.roundedge !== null, copy(tfp.roundedge, tsp.roundedge));\n    if(tsp.shadow !== null, copy(tfp.shadow, tsp.shadow));\n    if(tsp.shadowrange !== null, copy(tfp.shadowrange, tsp.shadowrange));\n    if(tsp.shadowangle !== null, copy(tfp.shadowangle, tsp.shadowangle));\n    if(tsp.shadowcolor !== null, copy(tfp.shadowcolor, tsp.shadowcolor));\n    if(tsp.shadowalpha !== null, copy(tfp.shadowalpha, tsp.shadowalpha));\n    if(tsp.textshadow !== null, copy(tfp.textshadow, tsp.textshadow));\n    if(tsp.textshadowrange !== null, copy(tfp.textshadowrange, tsp.textshadowrange));\n    if(tsp.textshadowangle !== null, copy(tfp.textshadowangle, tsp.textshadowangle));\n    if(tsp.textshadowcolor !== null, copy(tfp.textshadowcolor, tsp.textshadowcolor));\n    if(tsp.textshadowalpha !== null, copy(tfp.textshadowalpha, tsp.textshadowalpha));\n\n    if(tsp.alpha !== null, copy(tsp_alpha, tsp.alpha), set(tsp_alpha, 1.0));\n    if(tsp.showtime !== null, copy(tsp_showtime, tsp.showtime), set(tsp_showtime, 9999999999));\n    if(tsp.fadetime !== null, copy(tsp_fadetime, tsp.fadetime), set(tsp_fadetime, 0.0));\n    if(tsp.fadeintime !== null, copy(tsp_fadeintime, tsp.fadeintime), set(tsp_fadeintime, 0.0));\n    copy(showtextperm_timeout, tsp_showtime);\n    copy(showtextperm_fadeout, tsp_fadetime);\n    if(tsp_fadeintime GT 0,\n    set(tfp.alpha, 0.0);\n    tween(layer[showtextperm_tf].alpha, get(tsp_alpha), get(tsp_fadeintime), linear);\n    ,\n    copy(tfp.alpha, tsp_alpha);\n    );\n\n    if(tsp.noclip !== null, copy(showtextperm_clipping,tsp.noclip), set(showtextperm_clipping, true));\n\n    if(tsp.embeddedfonts !== null, copy(tfp.embeddedfontsp, tsp.embeddedfonts));\n    if(tsp.effect !== null, copy(tfp.effect, tsp.effect));\n    if(tsp.blendmode !== null, copy(tfp.blendmode, tsp.blendmode));\n\n    copy(tfp.html, showtextperm_text);\n    set(tfp.enabled, false);\n\n    if(tsp.parent, copy(tfp.parent, tsp.parent) );\n    set(tfp.url, "%SWFPATH%/plugins/textfield.swf");\n\n    delete(ts);\n    delete(tf);\n  </action>\n',"\n        ").concat(o,"\n        ").concat(i,"\n        ").concat('\n      <action name="hotspot_mouse_position" scope="local">\n        set(d, 1);\n        asyncloop(caller.loaded,\n          screentosphere(mouse.x, mouse.y, h, v);\n          spheretospace(h, v, d, x, y, z);\n          calc(fh, caller.camera_height - view.ty + view.oy_rotated);\n          calc(x, x * fh / y);\n          calc(z, z * fh / y);\n          set(caller, tx=calc(view.tx - view.ox_rotated + x), tz=calc(view.tz - view.oz_rotated + z), ty=calc(view.ty - view.oy_rotated + fh));\n        );\n      </action>\n    ',"\n      </krpano>\n    ");if(U.call("loadxml(".concat(a,", null, REMOVESCENES | IGNOREKEEP, BLEND(0.5));")),u.streetview.autorotate.enabled){var l=U.get("autorotate");l.enabled=!0,l.waittime=u.streetview.autorotate.waitTime,l.speed=u.streetview.autorotate.speed,l.horizon=0,l.tofov=120,U.addEventListener("click",(function(){u.streetview.autorotate.stopOnClick&&(l.enabled=!1)}),{once:!0,passive:!0})}}}),[u,U,j]),(0,o.useEffect)((function(){if(null===U)return function(){};var t,e=U.get("events").createItem("playerEvents");return e.keep=!0,e.onloadcomplete=function(){Y.current=!1,W(!0),C((function(t){return U.set("view.hlookat",t),t})),P((function(t){return U.set("view.vlookat",t),t})),T((function(t){return U.set("view.fov",t),t}))},e.onloaderror=function(){W(!0),Y.current=!1},e.onviewchanged=function(){clearTimeout(t),t=setTimeout((function(){C((function(t){var e=U.get("view.hlookat");return Y.current?t:e})),P((function(t){var e=U.get("view.vlookat");return Y.current?t:e})),T((function(t){var e=U.get("view.fov");return Y.current?t:e}))}),100)},function(){U.get("events").removeItem("playerEvents")}}),[U]),(0,o.useEffect)((function(){null!==u&&(C(u.streetview.hlookat.initial),P(u.streetview.vlookat.initial),T(u.streetview.fov.initial))}),[u]),(0,o.useEffect)((function(){var t=document.head,e=document.createElement("script");e.type="text/javascript",e.src="./krpano.js",e.onload=function(){if(null!==R.current){R.current.id=(0,x.Z)();var t="true"===new(y())(window.location.href,!0).query.preserveDrawingBuffer;window.krpanoJS.embedpano({swf:null,xml:null,id:(0,x.Z)(),target:R.current.id,consolelog:!0,pasQuerysParameters:!1,html5:"only",localfallback:"none",webglsettings:{preserveDrawingBuffer:t},onready:function(t){F(t)}})}},t.appendChild(e);var n=function(t){var e,n,o;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&!["INPUT","TEXTAREA"].includes(null!==(e=null===(n=document.activeElement)||void 0===n?void 0:n.tagName)&&void 0!==e?e:"")){var r=null===(o=R.current)||void 0===o?void 0:o.firstChild;r&&document.activeElement!==r&&r.focus()}};return document.addEventListener("keydown",n,!1),function(){var t;document.removeEventListener("keydown",n,!1),F(null),null!==R.current&&(R.current.textContent=""),null===(t=e.parentNode)||void 0===t||t.removeChild(e)}}),[]),(0,o.useEffect)((function(){var t;null!==(t=R.current)&&void 0!==t&&t.parentElement&&(q?R.current.parentElement.style.height=N:R.current.parentElement.style.removeProperty("height"))}),[q,N]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:K,style:{visibility:null===j?"hidden":"visible"},children:[(0,p.jsx)("div",{className:J,ref:R}),(0,p.jsx)(M,{config:u,krpano:U,selected:j,setSelected:S,setHlookatNoEffect:C,nearby:O,loaded:V,hotspotsVisible:L,setHotspotsVisible:I}),(0,p.jsx)(D,{config:u,krpano:U,selected:j,asset:z,loaded:V}),(0,p.jsxs)("div",{className:X,children:[(null===u||void 0===u?void 0:u.streetview.zoom.enabled)&&(0,p.jsx)(pt,{krpano:U}),(null===u||void 0===u?void 0:u.streetview.captureDate.enabled)&&(0,p.jsx)(vt,{config:u,selected:j,localeSelected:d||(0,s.UT)()}),(null===u||void 0===u?void 0:u.streetview.latLon.enabled)&&(0,p.jsx)(w.Z,{size:"small",label:"".concat(null!==(e=null===u||void 0===u||null===(n=u.translations)||void 0===n?void 0:n.STREETVIEW_LATLON_LABEL)&&void 0!==e?e:"",": ").concat(null===j||void 0===j?void 0:j.lat.toFixed(6)," ").concat(null===j||void 0===j?void 0:j.lon.toFixed(6))})]}),(0,p.jsx)(st,{config:u,selected:j,setSelected:S,next:A}),!q&&[gt.S.Map,gt.S.Streetview].includes(v.window)&&(0,p.jsx)(mt.Z,{config:u,onClick:$}),!q&&[gt.S.Map,gt.S.Streetview].includes(v.window)&&(0,p.jsx)(ht.Z,{config:u,onClick:function(){h((function(t){return{window:t.window===gt.S.Map?gt.S.Streetview:gt.S.Map,minimized:t.minimized}}))}})]}),(0,p.jsx)("div",{className:Q,children:(0,p.jsx)(g.ZP,{placement:"left",title:null!==(r=null===u||void 0===u||null===(i=u.translations)||void 0===i?void 0:i.STREETVIEW_MAXIMIZE_TOOLTIP)&&void 0!==r?r:"",children:(0,p.jsx)(m.Z,{size:"small",color:"primary",onClick:$,children:(0,p.jsx)(k.Z,{})})})})]})},bt=n(9003),yt=n(462),kt=n(3192),Zt=n(1749),_t=n(4144),Et=n.n(_t),jt=n(8995),St=n(9832);function Ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ct(Object(n),!0).forEach((function(e){(0,h.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Tt=(0,r.Z)((function(t){return{popover:{boxShadow:"none",backgroundColor:"transparent"},autocomplete:(0,h.Z)({width:400,marginRight:t.spacing(2),"& .MuiInputBase-root":{backgroundColor:t.palette.background.paper},"& .MuiOutlinedInput-notchedOutline":{border:0}},t.breakpoints.down("xs"),{width:300}),icon:{color:t.palette.text.secondary,marginRight:t.spacing(2)}}})),Ot=function(){var t=(0,C.Z)(T().mark((function t(e){var n,o,r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://nominatim.openstreetmap.org/search?q=".concat(encodeURIComponent(e),"&format=json"),t.next=3,Et()(n,{jsonpCallback:"json_callback"});case 3:return o=t.sent,t.next=6,o.json();case 6:return r=t.sent,t.abrupt("return",r.map((function(t){return{label:t.display_name,lon:+t.lon,lat:+t.lat}})));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),At=function(){var t=(0,C.Z)(T().mark((function t(e,n,o,r){var i,a,l,s,c,u,d,p,f,v,h,m,g,w,x,b,y,k,_;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.config,a=r.streetview,l=r.map,s=l.setCenter,c=l.setZoom,u=l.setFitPoints,d=a.timeline,p=a.setSelected,f=a.setHlookatNoEffect,v=a.setVlookatNoEffect,h=(0,O.kF)(e,n,15),m=(0,j.Z)(h,3),g=m[0],w=m[1],x=m[2],t.next=6,(0,Z.lM)(i.streetview.dataUrl,g,w,x);case 6:if(0!==(b=t.sent).length){t.next=11;break}return t.next=10,(0,Z.lM)(i.streetview.dataUrl,g,w,x,{nearby:!0});case 10:b=t.sent;case 11:(b=b.filter((function(t){return!d||t.timeline===d}))).sort((function(t,o){return(0,O.Lb)(n,e,t.lat,t.lon)-(0,O.Lb)(n,e,o.lat,o.lon)})),0===b.length?(s((0,O.mi)([e,n])),c(17)):(y=b,k=(0,j.Z)(y,1),_=k[0],p(_),window.requestAnimationFrame((function(){var t=(0,O.H5)(_.lat,_.lon,n,e)-_.heading;if(f(t),null!==o){var r=o-i.streetview.cameraHeight,a=(0,O.S3)(_.lat,_.lon,_.height,n,e,r);v(a)}u([(0,O.mi)([_.lon,_.lat]),(0,O.mi)([e,n])])})));case 14:case"end":return t.stop()}}),t)})));return function(e,n,o,r){return t.apply(this,arguments)}}(),Lt=function(t){var e,n,r,i,a=Tt(),l=(0,o.useContext)(s.ZP).config,c=(0,o.useContext)(Z.ZP),u=(0,o.useContext)(_.Z),d=u.searchPlace,f=u.setSearchPlace,v=(0,o.useState)(null),h=v[0],w=v[1],x=(0,o.useState)(""),b=x[0],y=x[1],k=(0,o.useState)([]),E=k[0],j=k[1],S=(0,o.useRef)(),P=null!==(e=null===l||void 0===l||null===(n=l.general.search)||void 0===n?void 0:n.enabled)&&void 0!==e&&e;return o.useEffect((function(){S.current&&clearTimeout(S.current),""!==b?S.current=setTimeout((0,C.Z)(T().mark((function t(){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=j,t.next=4,Ot(b);case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=12;break;case 8:t.prev=8,t.t2=t.catch(0),j([]),console.error(t.t2);case 12:case"end":return t.stop()}}),t,null,[[0,8]])}))),500):j([])}),[b]),(0,p.jsxs)(p.Fragment,{children:[P&&(0,p.jsx)(g.ZP,{placement:"left",title:null!==(r=null===l||void 0===l||null===(i=l.translations)||void 0===i?void 0:i.SEARCH_TOOLTIP)&&void 0!==r?r:"",children:(0,p.jsx)(m.Z,{size:"small",color:"primary",onClick:function(t){return w(t.currentTarget)},children:(0,p.jsx)(jt.Z,{})})}),(0,p.jsx)(bt.ZP,{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"right"},PaperProps:{classes:{root:a.popover}},open:null!==h,anchorEl:h,onClose:function(){return w(null)},children:(0,p.jsx)(yt.ZP,{freeSolo:!0,includeInputInList:!0,filterSelectedOptions:!0,autoComplete:!0,forcePopupIcon:!1,className:a.autocomplete,options:E,getOptionLabel:function(t){return t.label},filterOptions:function(t){return t},value:d,onChange:function(t,e){f(e),null!==e&&null!==l&&At(e.lon,e.lat,null,{config:l,streetview:c,map:u}),null!==e&&w(null),window.requestAnimationFrame((function(){document.activeElement.blur()}))},onInputChange:function(t,e){return y(e)},renderInput:function(t){var e,n;return(0,p.jsx)(kt.Z,Pt(Pt({},t),{},{label:"",placeholder:null!==(e=null===l||void 0===l||null===(n=l.translations)||void 0===n?void 0:n.SEARCH_TOOLTIP)&&void 0!==e?e:"",autoFocus:!0,variant:"outlined",fullWidth:!0}))},renderOption:function(t){return(0,p.jsxs)(Zt.Z,{container:!0,alignItems:"center",children:[(0,p.jsx)(Zt.Z,{item:!0,children:(0,p.jsx)(St.Z,{className:a.icon})}),(0,p.jsx)(Zt.Z,{item:!0,xs:!0,children:t.label})]})}})})]})},It=n(2303),zt=n(8914),Nt=(0,r.Z)((function(t){return{popover:{boxShadow:"none",backgroundColor:"transparent"},popoverContent:{padding:t.spacing(2),marginRight:t.spacing(2)},expandedContent:{display:"flex",flexDirection:"column",minWidth:100,"& button":{marginBottom:t.spacing(2)},"& button:last-child":{marginBottom:0}},expandedContentLayoutSplit:{position:"absolute",bottom:0,left:0,zIndex:1e3,padding:t.spacing(2),margin:t.spacing(2)},expandedContentLayoutOverlay:{position:"absolute",bottom:0,left:0,zIndex:1e3,padding:t.spacing(2),margin:t.spacing(4)}}})),Rt=function(){var t=(0,C.Z)(T().mark((function t(e,n,o){var r,i,a,l,s,c,u,d,p;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.config,e){t.next=3;break}return t.abrupt("return",null);case 3:return i=(0,O.kF)(e.lon,e.lat,15),a=(0,j.Z)(i,3),l=a[0],s=a[1],c=a[2],t.next=6,(0,Z.lM)(r.streetview.dataUrl,l,s,c);case 6:if(u=t.sent,(d=u.filter((function(t){return!n||t.timeline===n}))).sort((function(t,n){return(0,O.Lb)(e.lat,e.lon,t.lat,t.lon)-(0,O.Lb)(e.lat,e.lon,n.lat,n.lon)})),!(d.length>0)){t.next=11;break}return t.abrupt("return",d[0]);case 11:if(void 0===(p=r.timeline.timelinesInitial.find((function(t){return t.timeline===n})))){t.next=14;break}return t.abrupt("return",p);case 14:return t.abrupt("return",null);case 15:case"end":return t.stop()}}),t)})));return function(e,n,o){return t.apply(this,arguments)}}(),Mt=function(t){var e,n,r,i,a,l=Nt(),u=(0,o.useContext)(s.ZP).config,d=(0,o.useContext)(c.Z).layout,f=(0,o.useContext)(Z.ZP),v=f.selected,h=f.setSelected,w=f.timeline,x=f.setTimeline,b=(0,o.useContext)(_.Z).setCenter,y=(0,o.useState)(null),k=y[0],E=y[1],j=(0,o.useState)(""),S=j[0],P=j[1],A=null!==(e=null===u||void 0===u?void 0:u.timeline.expanded)&&void 0!==e&&e,L=null!==(n=null===u||void 0===u||null===(r=u.timeline)||void 0===r?void 0:r.timelines)&&void 0!==n?n:[],I=function(){var t=(0,C.Z)(T().mark((function t(e){var n,o,r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(E(null),null!==u&&null!==v){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,Rt(v,e.target.value,{config:u});case 5:if(n=t.sent){t.next=9;break}return P((null!==(o=null===u||void 0===u||null===(r=u.translations)||void 0===r?void 0:r.TIMELINE_ERROR_NO_NEARBY_STREETVIEWS)&&void 0!==o?o:"").replace("{timeline}",e.target.value)),t.abrupt("return");case 9:h(n),b((0,O.mi)([n.lon,n.lat])),x(e.target.value);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),z=(0,p.jsx)("div",{className:l.expandedContent,children:L.map((function(t){return(0,p.jsx)(U.Z,{variant:"contained",color:t===w?"primary":"default",onClick:function(){I({target:{value:t}})},children:t},t)}))}),N=[];return[gt.S.Map,gt.S.Streetview].includes(d.window)&&N.push(l.expandedContentLayoutOverlay),[gt.S.StreetviewBottomMapTop,gt.S.StreetviewTopMapBottom].includes(d.window)&&N.push(l.expandedContentLayoutSplit),(0,p.jsxs)(p.Fragment,{children:[A&&(0,p.jsx)(W.Z,{className:N.join(" "),children:z}),!A&&(0,p.jsx)(g.ZP,{placement:"left",title:null!==(i=null===u||void 0===u||null===(a=u.translations)||void 0===a?void 0:a.TIMELINE_TOOLTIP)&&void 0!==i?i:"",children:(0,p.jsx)(m.Z,{size:"small",color:"primary",onClick:function(t){return E(t.currentTarget)},children:(0,p.jsx)(It.Z,{})})}),(0,p.jsx)(bt.ZP,{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"right"},PaperProps:{classes:{root:l.popover}},open:null!==k,anchorEl:k,onClose:function(){return E(null)},children:(0,p.jsx)(W.Z,{className:l.popoverContent,children:z})}),S&&(0,p.jsx)(zt.Z,{error:S,setError:P})]})},Dt=n(1163),Ht=n(6912),Ut=n(3093),Ft=n(366),Bt=n(6374),Vt=function(t,e,n,o){var r=e.selected,i=e.hlookat,a=e.vlookat,l=e.fov,s=n.center,c=n.zoom,u=n.provider,d=o.layout,p=d.window,f=d.minimized;if(null===t||null===r||null===u)return"";var v=t.map.providers.indexOf(u),h=[1,[r.id,r.heading,r.height,r.lat,r.lon,r.date,r.timeline,r.tileFormat],[i,a,l],[(0,O.bU)(s),c,v],[p,f]],m=Bt.encode(h);return btoa(String.fromCharCode.apply(null,m))},Wt=(0,r.Z)((function(t){return{snackbarRoot:{overflow:"hidden",backgroundColor:"initial",boxShadow:"none"}}})),Yt=function(t){var e,n,r,i,a,l=Wt(),u=(0,Dt.useRouter)(),d=(0,o.useContext)(s.ZP).config,f=(0,o.useContext)(Z.ZP),v=(0,o.useContext)(_.Z),h=(0,o.useContext)(c.Z),w=(0,o.useState)(!1),x=w[0],b=w[1];return(0,o.useEffect)((function(){var t=function(t){var e=t.data,n=t.origin,o=t.source;if(null!==d&&null!==v.provider&&"player-next-config-get"===e){var r=d.map.providers.indexOf(v.provider),i={general:{layout:h.layout},streetview:{initial:f.selected,hlookat:{initial:f.hlookat},vlookat:{initial:f.vlookat},fov:{initial:f.fov}},map:{view:{center:(0,O.bU)(v.center),zoom:v.zoom},providerInitial:r}};null===o||o instanceof MessagePort||o instanceof ServiceWorker||null===o||void 0===o||o.postMessage({action:"player-next-config",value:i},n)}};return window.addEventListener("message",t,!1),function(){window.removeEventListener("message",t,!1)}}),[d,f,v,h]),(0,p.jsxs)(p.Fragment,{children:[!0===(null===d||void 0===d||null===(e=d.general)||void 0===e?void 0:e.share.enabled)&&(0,p.jsx)(g.ZP,{placement:"left",title:null!==(n=null===d||void 0===d||null===(r=d.translations)||void 0===r?void 0:r.SHARE_TOOLTIP)&&void 0!==n?n:"",children:(0,p.jsx)(m.Z,{size:"small",color:"primary",onClick:function(t){t.stopPropagation();var e=encodeURIComponent(Vt(d,f,v,h)),n=new(y())(u.asPath,!0).query,o=Object.entries(n).filter((function(t){return 0===(0,j.Z)(t,1)[0].indexOf("v_")})).map((function(t){var e=(0,j.Z)(t,2),n=e[0],o=e[1];return"".concat(n,"=").concat(encodeURIComponent(null!==o&&void 0!==o?o:""))})).join("&"),r={title:"Share",url:"".concat(window.location.origin).concat(window.location.pathname,"?share=").concat(e,"&").concat(o)};navigator.share?navigator.share(r):navigator.clipboard?(navigator.clipboard.writeText(r.url),b(!0)):function(t,e){var n,o;try{(n=document.createElement("textarea")).setAttribute("readonly","true"),n.setAttribute("contenteditable","true"),n.style.position="fixed",n.value=t,e.appendChild(n),n.focus(),n.select();var r=document.createRange();r.selectNodeContents(n);var i=window.getSelection();if(null===i)return!1;i.removeAllRanges(),i.addRange(r),n.setSelectionRange(0,n.value.length),o=document.execCommand("copy")}catch(l){console.error(l),o=null}finally{n&&e.removeChild(n)}if(!o){var a=navigator.platform.toUpperCase().indexOf("MAC")>=0;if(!(o=prompt("Press ".concat(a?"\u2318C":"CTRL+C"),t)))return!1}return!0}(r.url,document.body)&&b(!0)},children:(0,p.jsx)(Ut.Z,{})})}),x&&(0,p.jsx)(bt.ZP,{open:!0,PaperProps:{classes:{root:l.snackbarRoot}},anchorReference:"anchorPosition",anchorPosition:{top:0,left:0},children:(0,p.jsx)(Ht.Z,{open:!0,message:null!==(i=null===d||void 0===d||null===(a=d.translations)||void 0===a?void 0:a.SHARE_COPIED_CLIPBOARD)&&void 0!==i?i:"",autoHideDuration:1e4,onClose:function(){return b(!1)},anchorOrigin:{vertical:"top",horizontal:"center"},action:(0,p.jsx)(B.Z,{color:"inherit",onClick:function(){return b(!1)},children:(0,p.jsx)(Ft.Z,{})})})})]})},qt=n(1846),Gt=n(7162),Kt=n(553),Xt=n(9584),Qt=(0,r.Z)((function(t){return{popover:{boxShadow:"none",backgroundColor:"transparent"},content:{padding:t.spacing(2),marginRight:t.spacing(2)}}})),Jt=function(t){var e,n,r=Qt(),i=(0,o.useContext)(s.ZP),a=i.config,l=i.locales,c=i.localeSelected,u=i.setLocaleSelected,d=(0,o.useState)(null),f=d[0],v=d[1];return(0,p.jsxs)(p.Fragment,{children:[""!==c&&(0,p.jsx)(g.ZP,{placement:"left",title:null!==(e=null===a||void 0===a||null===(n=a.translations)||void 0===n?void 0:n.LANGUAGE_SELECT_TOOLTIP)&&void 0!==e?e:"",children:(0,p.jsx)(m.Z,{size:"small",color:"primary",onClick:function(t){return v(t.currentTarget)},children:(0,p.jsx)(Xt.Z,{})})}),(0,p.jsx)(bt.ZP,{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"right"},PaperProps:{classes:{root:r.popover}},open:null!==f,anchorEl:f,onClose:function(){return v(null)},children:(0,p.jsx)(W.Z,{className:r.content,children:(0,p.jsx)(Gt.Z,{value:c,onChange:function(t,e){return u(e)},children:l.map((function(t){return(0,p.jsx)(Kt.Z,{value:t.locale,control:(0,p.jsx)(qt.Z,{}),label:t.label},t.locale)}))})})})]})},$t=function(t){var e=(0,Dt.useRouter)(),n=(0,o.useRef)(!0),r=(0,o.useContext)(s.ZP).config,i=(0,o.useContext)(Z.ZP),a=i.selected,l=(0,o.useContext)(_.Z),c=l.setAsset,u=(0,o.useMemo)((function(){return new(y())(e.asPath,!0).query}),[e.asPath]);return(0,o.useEffect)((function(){var t,e,o,s,d,p=+(null!==(t=u.v_lng)&&void 0!==t?t:0),f=+(null!==(e=u.v_lat)&&void 0!==e?e:0),v=u.v_alt?+(null!==(o=u.v_alt)&&void 0!==o?o:0):null,h=null!==(s=u.v_label)&&void 0!==s?s:"",m=null!==(d=u.share)&&void 0!==d?d:"";null!==r&&null!==a&&p&&f&&n.current&&(c({lon:p,lat:f,alt:v,label:h}),m||At(p,f,v,{config:r,streetview:i,map:l}),n.current=!1)}),[a]),null},te=(0,o.memo)($t),ee=function(t){var e=(0,o.useContext)(s.ZP).config,n=(0,o.useContext)(Z.ZP),r=n.selected,i=n.setSelected,a=n.timeline,l=n.setTimeline,c=(n.hotspotsVisible,n.setHotspotsVisible),u=(0,o.useContext)(_.Z),d=u.setCenter,p=u.setAsset;return(0,o.useEffect)((function(){if(null===e||window.parent===window)return function(){};var t=function(t){var o,r=t.detail;r&&r.lon&&r.lat&&At(r.lon,r.lat,null!==(o=r.alt)&&void 0!==o?o:null,{config:e,streetview:n,map:u})};return window.document.addEventListener("playerLookAt",t,!1),function(){window.document.removeEventListener("playerLookAt",t,!1)}}),[e,a]),(0,o.useEffect)((function(){if(null===e||window.parent===window)return function(){};var t=function(t){var e,n=t.detail;n?n.lon&&n.lat&&p({lon:n.lon,lat:n.lat,alt:null!==(e=n.alt)&&void 0!==e?e:null,label:n.label}):p(null)};return window.document.addEventListener("assetUpdate",t,!1),function(){window.document.removeEventListener("assetUpdate",t,!1)}}),[e]),(0,o.useEffect)((function(){if(null===e||window.parent===window)return function(){};var t=function(){var t=(0,C.Z)(T().mark((function t(n){var o,a;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return console.error("No streetview selected"),t.abrupt("return");case 3:if(o=n.detail,e.timeline.timelines.includes(o)){t.next=7;break}return console.error("Timeline ".concat(o," does not exist in timeline list ").concat(e.timeline.timelines.join(", "),".")),t.abrupt("return");case 7:return t.next=9,Rt(r,o,{config:e});case 9:if(a=t.sent){t.next=13;break}return console.error("No streetviews nearby in ".concat(o," timeline.")),t.abrupt("return");case 13:i(a),d((0,O.mi)([a.lon,a.lat])),l(o);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return window.document.addEventListener("timelineChange",t,!1),function(){window.document.removeEventListener("timelineChange",t,!1)}}),[e,r]),(0,o.useEffect)((function(){if(null===e||window.parent===window)return function(){};var t=function(){var t=(0,C.Z)(T().mark((function t(e){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c(e.detail);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return window.document.addEventListener("hotspotsVisibleChange",t,!1),function(){window.document.removeEventListener("hotspotsVisibleChange",t,!1)}}),[e]),null},ne=(0,o.memo)(ee),oe=(0,i.default)((function(){return Promise.all([n.e(315),n.e(100)]).then(n.bind(n,5731))}),{ssr:!1,loadableGenerated:{webpack:function(){return[5731]},modules:["index.tsx -> ../src/components/Map"]}}),re=(0,r.Z)((function(t){return{content:{flexGrow:1},controls:{display:"flex",flexDirection:"column",position:"absolute",top:0,right:0,zIndex:200,margin:t.spacing(2),"& > button":{marginTop:t.spacing(1)},"@media (min-height: 500px)":{top:"50%",transform:"translate(0, -50%)"}},controlsLayoutSplit:{transform:"translate(0, 0)"},error:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}));var ie=function(){var t=re(),e=(0,o.useContext)(s.ZP).config,n=(0,o.useContext)(c.Z).layout,r=[t.controls].join(" ");return[gt.S.StreetviewBottomMapTop,gt.S.StreetviewTopMapBottom].includes(n.window)&&(r=[t.controls,t.controlsLayoutSplit].join(" ")),"file:"===window.location.protocol?(0,p.jsxs)(a.Z,{severity:"error",className:t.error,children:[(0,p.jsx)(l.Z,{children:"Error"}),(0,p.jsx)("p",{children:"Can't run without a web server."}),(0,p.jsx)("p",{children:"Copy the output folder to a web server and access it via http or https."})]}):(0,p.jsxs)("main",{className:t.content,children:[(0,p.jsx)(v,{}),(0,p.jsx)(oe,{}),(0,p.jsx)(xt,{}),(null===e||void 0===e?void 0:e.timeline.enabled)&&(null===e||void 0===e?void 0:e.timeline.expanded)&&(0,p.jsx)(Mt,{}),(0,p.jsxs)("div",{className:r,children:[(0,p.jsx)(Lt,{}),(null===e||void 0===e?void 0:e.timeline.enabled)&&!(null!==e&&void 0!==e&&e.timeline.expanded)&&(0,p.jsx)(Mt,{}),(0,p.jsx)(Yt,{}),(0,p.jsx)(Jt,{}),(0,p.jsx)(te,{})]}),(0,p.jsx)(ne,{})]})}},2945:function(t,e,n){"use strict";n(7294);var o=n(4720),r=n(868),i=n(1120),a=n(64),l=n(5893),s=(0,i.Z)((function(t){return{root:{backgroundColor:t.palette.background.paper,borderRadius:t.shape.borderRadius,cursor:"pointer",position:"absolute",top:0,left:0,margin:t.spacing(1),width:24,height:18}}}));e.Z=function(t){var e,n,i=t.config,c=t.onClick,u=s();return(0,l.jsx)(r.ZP,{placement:"right",title:null!==(e=null===i||void 0===i||null===(n=i.translations)||void 0===n?void 0:n.LAYOUT_MINIMIZE_TOOLTIP)&&void 0!==e?e:"",children:(0,l.jsx)(o.Z,{className:u.root,onClick:function(){return c()},children:(0,l.jsx)(a.Z,{})})})}},6644:function(t,e,n){"use strict";n(7294);var o=n(4720),r=n(868),i=n(1120),a=n(1197),l=n(5893),s="undefined"!==typeof navigator&&(navigator.userAgent.indexOf("MSIE ")>-1||navigator.userAgent.indexOf("Trident/")>-1),c=(0,i.Z)((function(t){return{root:{position:"absolute",top:0,right:0,height:64,width:64,overflow:"hidden",pointerEvents:"none"},box:{position:"absolute",top:-10,right:-32,height:50,width:90,transform:"rotate(45deg)",backgroundColor:"#212121",opacity:.5,pointerEvents:"auto"},icon:{position:"absolute",top:0,right:0,transform:"rotate(-45deg)",color:"#ffffff"}}}));e.Z=function(t){var e,n,i=t.config,u=t.onClick,d=c();return(0,l.jsx)(r.ZP,{placement:"left",title:null!==(e=null===i||void 0===i||null===(n=i.translations)||void 0===n?void 0:n.LAYOUT_SWITCH_TOOLTIP)&&void 0!==e?e:"",children:(0,l.jsxs)(o.Z,{className:d.root,onClick:s?function(){return u()}:void 0,children:[(0,l.jsx)("div",{className:d.box,onClick:s?void 0:function(){return u()}}),(0,l.jsx)(a.Z,{fontSize:"large",className:d.icon})]})})}},8914:function(t,e,n){"use strict";n(7294);var o=n(9003),r=n(6912),i=n(7812),a=n(4562),l=n(1120),s=n(366),c=n(5893),u=(0,l.Z)((function(t){return{root:{overflow:"hidden",backgroundColor:"initial",boxShadow:"none"}}}));e.Z=function(t){var e=t.error,n=t.setError,l=u();return(0,c.jsx)(o.ZP,{open:!0,PaperProps:{classes:{root:l.root}},anchorReference:"anchorPosition",anchorPosition:{top:0,left:0},children:(0,c.jsx)(r.Z,{open:!0,autoHideDuration:1e4,onClose:function(){return n("")},anchorOrigin:{vertical:"top",horizontal:"center"},action:(0,c.jsx)(i.Z,{color:"inherit",onClick:function(){return n("")},children:(0,c.jsx)(s.Z,{})}),children:(0,c.jsx)(a.Z,{severity:"error",elevation:6,variant:"filled",onClose:function(){return n("")},children:e})})})}},6569:function(t,e,n){"use strict";var o=n(7294);e.Z=function(){var t=(0,o.useState)("".concat(window.innerHeight,"px")),e=t[0],n=t[1];return(0,o.useEffect)((function(){var t=function(){return n("".concat(window.innerHeight,"px"))};return window.addEventListener("resize",t),window.addEventListener("orientationchange",t),function(){window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)}}),[]),e}},5301:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(7923)}])}},function(t){t.O(0,[774,807,888,179],(function(){return e=5301,t(t.s=e);var e}));var e=t.O();_N_E=e}]);